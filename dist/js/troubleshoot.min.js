!function(){class t{constructor(){this.currentStep=0,this.totalSteps=0,this.results=[],this.isRunning=!1}async init(t=null){this.repoId=t,this.createTroubleshootUI(),this.renderSteps(),this.bindEvents(),this.updateProgress(0,this.totalSteps,WPGitManagerTroubleshoot.translations.readyToStart),this.applyRTLSupport();try{if(this.repoId){const t=await this.makeAjaxRequest("git_manager_get_repo_details",{id:this.repoId});if(t.success&&t.data){const e=t.data.path||WPGitManagerTroubleshoot.translations.unknown,s=t.data.name||WPGitManagerTroubleshoot.translations.unknown,o=document.querySelector('[data-step-id="repo-path"] .step-description');o&&(o.innerHTML=`${WPGitManagerTroubleshoot.translations.verifyingRepositoryPath}<br><small style="color: #666;">${WPGitManagerTroubleshoot.translations.repository}: ${s}<br>${WPGitManagerTroubleshoot.translations.currentPath}: ${e}</small>`)}}else{const t=await this.makeAjaxRequest("git_manager_bulk_repo_status",{});if(t.success&&t.data){const e=Object.keys(t.data);if(e.length>0){const s=e[0],o=t.data[s];if(o&&o.currentBranch){const t=document.querySelector('[data-step-id="repo-path"] .step-description');t&&(t.innerHTML=`${WPGitManagerTroubleshoot.translations.verifyingRepositoryPath}<br><small style="color: #666;">${WPGitManagerTroubleshoot.translations.currentPath}: ${WPGitManagerTroubleshoot.translations.unknown}</small>`)}}}}}catch(t){}}createTroubleshootUI(){const t=document.getElementById("repo-manager-output")||document.getElementById("troubleshoot-output");if(!t)return;const e=`\n            <div id="troubleshoot-enhanced" class="troubleshoot-container">\n                <div class="troubleshoot-header">\n                    <div class="troubleshoot-title">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 17v4"/><path d="m14.305 7.53.923-.382"/><path d="m15.228 4.852-.923-.383"/><path d="m16.852 3.228-.383-.924"/><path d="m16.852 8.772-.383.923"/><path d="m19.148 3.228.383-.924"/><path d="m19.53 9.696-.382-.924"/><path d="m20.772 4.852.924-.383"/><path d="m20.772 7.148.924.383"/><path d="M22 13v2a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"/><path d="M8 21h8"/><circle cx="18" cy="6" r="3"/></svg>\n                        <span>${WPGitManagerTroubleshoot.translations.gitManagerTroubleshooting}</span>\n                    </div>\n                    <div class="troubleshoot-progress">\n                        <div class="progress-bar">\n                            <div class="progress-fill animating" id="troubleshoot-progress-fill"></div>\n                        </div>\n                        <span class="progress-text" id="troubleshoot-progress-text">${WPGitManagerTroubleshoot.translations.readyToStart}</span>\n                    </div>\n                </div>\n\n                <div class="troubleshoot-steps" id="troubleshoot-steps">\n                    \x3c!-- Steps will be populated here --\x3e\n                </div>\n\n                <div class="troubleshoot-actions">\n                    <button id="troubleshoot-start" class="btn btn-primary troubleshoot-btn">\n                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>\n                        ${WPGitManagerTroubleshoot.translations.startTroubleshooting}\n                    </button>\n                    <button id="troubleshoot-stop" class="btn btn-secondary troubleshoot-btn" style="display: none;">\n                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/></svg>\n                        ${WPGitManagerTroubleshoot.translations.stop}\n                    </button>\n                    <button id="troubleshoot-reset" class="btn btn-outline troubleshoot-btn">\n                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>\n                        ${WPGitManagerTroubleshoot.translations.reset}\n                    </button>\n                </div>\n\n                <div class="troubleshoot-summary" id="troubleshoot-summary" style="display: none;">\n                    \x3c!-- Summary will be shown here --\x3e\n                </div>\n            </div>\n        `;t.innerHTML=e,t.classList.add("troubleshoot-mode")}getTroubleshootSteps(){return[{id:"repo-path",title:WPGitManagerTroubleshoot.translations.repositoryPathCheck,description:WPGitManagerTroubleshoot.translations.verifyingRepositoryPath,icon:"fa-folder",category:"basic"},{id:"git-binary",title:WPGitManagerTroubleshoot.translations.gitBinaryCheck,description:WPGitManagerTroubleshoot.translations.checkingGitInstalled,icon:"fa-code-branch",category:"basic"},{id:"git-directory",title:WPGitManagerTroubleshoot.translations.gitDirectoryCheck,description:WPGitManagerTroubleshoot.translations.verifyingGitDirectory,icon:"fa-git-alt",category:"basic"},{id:"safe-directory",title:WPGitManagerTroubleshoot.translations.safeDirectoryConfiguration,description:WPGitManagerTroubleshoot.translations.checkingSafeDirectory,icon:"fa-shield-halved",category:"security"},{id:"permissions",title:WPGitManagerTroubleshoot.translations.filePermissions,description:WPGitManagerTroubleshoot.translations.checkingPermissions,icon:"fa-key",category:"security"},{id:"ssh-directory",title:WPGitManagerTroubleshoot.translations.sshDirectorySetup,description:WPGitManagerTroubleshoot.translations.verifyingSSHDirectory,icon:"fa-terminal",category:"ssh"},{id:"ssh-keys",title:WPGitManagerTroubleshoot.translations.sshKeyDetection,description:WPGitManagerTroubleshoot.translations.checkingSSHKeys,icon:"fa-key",category:"ssh"},{id:"host-keys",title:WPGitManagerTroubleshoot.translations.hostKeyVerification,description:WPGitManagerTroubleshoot.translations.checkingHostKeys,icon:"fa-server",category:"ssh"},{id:"git-config",title:WPGitManagerTroubleshoot.translations.gitConfiguration,description:WPGitManagerTroubleshoot.translations.verifyingGitConfig,icon:"fa-cog",category:"config"},{id:"remote-test",title:WPGitManagerTroubleshoot.translations.remoteConnectionTest,description:WPGitManagerTroubleshoot.translations.testingRemoteConnection,icon:"fa-wifi",category:"network"}]}renderSteps(){const t=document.getElementById("troubleshoot-steps"),e=this.getTroubleshootSteps();this.totalSteps=e.length;let s="";e.forEach((t,e)=>{s+=`\n                <div class="troubleshoot-step" data-step="${e}" data-step-id="${t.id}">\n                    <div class="step-header">\n                                                 <div class="step-icon" data-icon="${t.icon}">\n                             ${this.getLucideIcon(t.icon)}\n                         </div>\n                        <div class="step-info">\n                            <div class="step-title">${t.title}</div>\n                            <div class="step-description">${t.description}</div>\n                        </div>\n                        <div class="step-status">\n                                                     <div class="status-icon" id="status-${t.id}">\n                             <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/></svg>\n                         </div>\n                        </div>\n                    </div>\n                    <div class="step-content" id="content-${t.id}" style="display: none;">\n                        <div class="step-log" id="log-${t.id}"></div>\n                        <div class="step-solution" id="solution-${t.id}" style="display: none;"></div>\n                    </div>\n                </div>\n            `}),t.innerHTML=s}bindEvents(){document.getElementById("troubleshoot-start")?.addEventListener("click",()=>{this.startTroubleshooting()}),document.getElementById("troubleshoot-stop")?.addEventListener("click",()=>{this.stopTroubleshooting()}),document.getElementById("troubleshoot-reset")?.addEventListener("click",()=>{this.resetTroubleshooting()}),document.addEventListener("click",t=>{if(t.target.closest(".step-header")){const e=t.target.closest(".troubleshoot-step"),s=e.dataset.stepId,o=document.getElementById(`content-${s}`);o&&(o.style.display="none"===o.style.display?"block":"none",e.classList.toggle("expanded"))}})}async startTroubleshooting(){this.isRunning||(this.isRunning=!0,this.currentStep=0,this.results=[],document.getElementById("troubleshoot-start").style.display="none",document.getElementById("troubleshoot-stop").style.display="inline-flex",document.getElementById("troubleshoot-summary").style.display="none",this.renderSteps(),await this.processSteps())}async processSteps(){const t=this.getTroubleshootSteps();for(let e=0;e<t.length&&this.isRunning;e++){this.currentStep=e;const s=t[e];this.updateProgress(e+1,t.length,`Running: ${s.title}`),this.updateStepStatus(s.id,"running");try{const t=await this.executeStep(s);this.results.push(t),this.updateStepStatus(s.id,t.status),this.showStepContent(s.id,t),await this.delay(500)}catch(t){this.updateStepStatus(s.id,"error"),this.results.push({stepId:s.id,status:"error",message:t.message,solution:"An unexpected error occurred. Please try again."})}}this.showSummary(),this.isRunning=!1,document.getElementById("troubleshoot-start").style.display="inline-flex",document.getElementById("troubleshoot-stop").style.display="none",this.updateProgress(0,0,WPGitManagerTroubleshoot.translations.troubleshootingCompleted)}async executeStep(t){const e=t.id;try{switch(e){case"repo-path":return await this.checkRepoPath();case"git-binary":return await this.checkGitBinary();case"git-directory":return await this.checkGitDirectory();case"safe-directory":return await this.checkSafeDirectory();case"permissions":return await this.checkPermissions();case"ssh-directory":return await this.checkSshDirectory();case"ssh-keys":return await this.checkSshKeys();case"host-keys":return await this.checkHostKeys();case"git-config":return await this.checkGitConfig();case"remote-test":return await this.testRemoteConnection();default:throw new Error(`Unknown step: ${e}`)}}catch(s){return{stepId:e,status:"error",message:`Failed to execute ${t.title}: ${s.message}`,solution:"Please check the browser console for more details and try again.",details:s.stack||s.message}}}async checkRepoPath(){try{const t={step:"repo-path"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"repo-path",status:e.data.status||(e.success?"success":"error"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"repo-path",status:"error",message:WPGitManagerTroubleshoot.translations.failedToCheckPath,solution:WPGitManagerTroubleshoot.translations.verifyPathInSettings}}}async checkGitBinary(){try{const t={step:"git-binary"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"git-binary",status:e.data.status||(e.success?"success":"error"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"git-binary",status:"error",message:WPGitManagerTroubleshoot.translations.failedToCheckGit,solution:WPGitManagerTroubleshoot.translations.ensureGitInstalled}}}async checkGitDirectory(){try{const t={step:"git-directory"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"git-directory",status:e.data.status||(e.success?"success":"error"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"git-directory",status:"error",message:WPGitManagerTroubleshoot.translations.failedToCheckDirectory,solution:WPGitManagerTroubleshoot.translations.ensureValidRepository}}}async checkSafeDirectory(){try{const t={step:"safe-directory"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"safe-directory",status:e.data.status||(e.success?"success":"warning"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"safe-directory",status:"error",message:WPGitManagerTroubleshoot.translations.failedToCheckSafeDirectory,solution:WPGitManagerTroubleshoot.translations.checkGitConfigManually}}}async checkPermissions(){try{const t={step:"permissions"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"permissions",status:e.data.status||(e.success?"success":"warning"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"permissions",status:"error",message:WPGitManagerTroubleshoot.translations.failedToCheckPermissions,solution:WPGitManagerTroubleshoot.translations.checkPermissionsManually}}}async checkSshDirectory(){try{const t={step:"ssh-directory"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"ssh-directory",status:e.data.status||(e.success?"success":"warning"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"ssh-directory",status:"error",message:WPGitManagerTroubleshoot.translations.failedToCheckSSH,solution:WPGitManagerTroubleshoot.translations.checkSSHManually}}}async checkSshKeys(){try{const t={step:"ssh-keys"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"ssh-keys",status:e.data.status||(e.success?"success":"warning"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"ssh-keys",status:"error",message:"Failed to check SSH keys",solution:"Please check SSH keys manually"}}}async checkHostKeys(){try{const t={step:"host-keys"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"host-keys",status:e.data.status||(e.success?"success":"warning"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"host-keys",status:"error",message:"Failed to check host keys",solution:"Please check host keys manually"}}}async checkGitConfig(){try{const t={step:"git-config"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"git-config",status:e.data.status||(e.success?"success":"warning"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"git-config",status:"error",message:"Failed to check Git configuration",solution:"Please check Git configuration manually"}}}async testRemoteConnection(){try{const t={step:"remote-test"};this.repoId&&(t.repo_id=this.repoId);const e=await this.makeAjaxRequest("git_manager_troubleshoot_step",t);return{stepId:"remote-test",status:e.data.status||(e.success?"success":"warning"),message:e.data.message,solution:e.data.solution||null,details:e.data.details||null}}catch(t){return{stepId:"remote-test",status:"error",message:"Failed to test remote connection",solution:"Please check network connectivity and remote URL"}}}getLucideIcon(t){return{"fa-folder":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 10.5 8 13l2 2.5"/><path d="m14 10.5 2 2.5-2 2.5"/><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2z"/></svg>',"fa-code-branch":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><line x1="3" x2="9" y1="12" y2="12"/><line x1="15" x2="21" y1="12" y2="12"/></svg>',"fa-git-alt":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v5"/><circle cx="13" cy="12" r="2"/><path d="M18 19c-2.8 0-5-2.2-5-5v8"/><circle cx="20" cy="19" r="2"/></svg>',"fa-shield-halved":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/><path d="M9 12h6"/><path d="M12 9v6"/></svg>',"fa-key":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v6"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><circle cx="4" cy="16" r="2"/><path d="m10 10-4.5 4.5"/><path d="m9 11 1 1"/></svg>',"fa-terminal":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19h8"/><path d="m4 17 6-6-6-6"/></svg>',"fa-server":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="8" x="2" y="2" rx="2" ry="2"/><rect width="20" height="8" x="2" y="14" rx="2" ry="2"/><line x1="6" x2="6.01" y1="6" y2="6"/><line x1="6" x2="6.01" y1="18" y2="18"/></svg>',"fa-cog":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 10.27 7 3.34"/><path d="m11 13.73-4 6.93"/><path d="M12 22v-2"/><path d="M12 2v2"/><path d="M14 12h8"/><path d="m17 20.66-1-1.73"/><path d="m17 3.34-1 1.73"/><path d="M2 12h2"/><path d="m20.66 17-1.73-1"/><path d="m20.66 7-1.73 1"/><path d="m3.34 17 1.73-1"/><path d="m3.34 7 1.73 1"/><circle cx="12" cy="12" r="2"/><circle cx="12" cy="12" r="8"/></svg>',"fa-wifi":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 19a1 1 0 0 1-1-1v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2a1 1 0 0 1-1 1z"/><path d="M17 21v-2"/><path d="M19 14V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V10"/><path d="M21 21v-2"/><path d="M3 5V3"/><path d="M4 10a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2a2 2 0 0 1-2 2z"/><path d="M7 5V3"/></svg>'}[t]||'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9.09 9 3.83 3.83L16.91 9"/></svg>'}updateStepStatus(t,e){const s=document.getElementById(`status-${t}`);if(s)switch(s.className="status-icon",e){case"running":s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"/></svg>',s.classList.add("status-running");break;case"success":s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M18 13a6 6 0 0 1-6 5 6 6 0 0 1-6-5h12Z"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></svg>',s.classList.add("status-success");break;case"warning":s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="8" x2="16" y1="15" y2="15"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></svg>',s.classList.add("status-warning");break;case"error":s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M16 16s-1.5-2-4-2-4 2-4 2"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></svg>',s.classList.add("status-error");break;default:s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>',s.classList.add("status-pending")}}showStepContent(t,e){const s=document.getElementById(`log-${t}`),o=document.getElementById(`solution-${t}`),n=document.getElementById(`content-${t}`);s&&o&&n&&(s.innerHTML=`\n             <div class="step-message ${e.status}">\n                 ${this.getStatusIcon(e.status)}\n                 <span>${e.message}</span>\n             </div>\n             ${e.details?`<div class="step-details">${e.details}</div>`:""}\n         `,e.solution&&(o.innerHTML=`\n                 <div class="solution-content">\n                     <h4><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 12l2 2 4-4"/><path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9"/></svg> Solution</h4>\n                     <div class="solution-text">${e.solution}</div>\n                 </div>\n             `,o.style.display="block"),n.style.display="block",this.applyRTLToNewContent())}showSummary(){const t=document.getElementById("troubleshoot-summary");if(!t)return;const e=`\n             <div class="troubleshoot-summary-content">\n                 <h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 5h13"/><path d="M13 12h8"/><path d="M13 19h8"/><path d="M3 10a2 2 0 0 0 2 2h3"/><path d="M3 5v12a2 2 0 0 0 2 2h3"/></svg> Troubleshooting Summary</h3>\n                 <div class="summary-stats">\n                     <div class="stat-item success">\n                         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 20h20"/><path d="m9 10 2 2 4-4"/><rect x="3" y="4" width="18" height="12" rx="2"/></svg>\n                         <span>${this.results.filter(t=>"success"===t.status).length} Passed</span>\n                     </div>\n                     <div class="stat-item warning">\n                         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>\n                         <span>${this.results.filter(t=>"warning"===t.status).length} Warnings</span>\n                     </div>\n                     <div class="stat-item danger">\n                         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 9-6 6"/><path d="M2.586 16.726A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2h6.624a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688-4.688A2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586z"/><path d="m9 9 6 6"/></svg>\n                         <span>${this.results.filter(t=>"error"===t.status).length} Failed</span>\n                     </div>\n                 </div>\n                 ${this.generateSummaryRecommendations()}\n             </div>\n         `;t.innerHTML=e,t.style.display="block",this.applyRTLToNewContent()}generateSummaryRecommendations(){const t=this.results.filter(t=>"error"===t.status),e=this.results.filter(t=>"warning"===t.status);if(0===t.length&&0===e.length)return'\n                 <div class="summary-recommendation success">\n                     <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 10v12"/><path d="M15 4.01v3"/><path d="M15 19.01v-3"/><path d="M15 4.01c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2z"/><path d="M7 10c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2z"/></svg>\n                     <div>\n                         <strong>All checks passed!</strong>\n                         <p>Your Git setup appears to be working correctly. You should be able to use all Repo Manager features.</p>\n                     </div>\n                 </div>\n             ';let s='<div class="summary-recommendations">';return t.length>0&&(s+=`\n                 <div class="recommendation-section">\n                     <h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 5h8"/><path d="M13 12h8"/><path d="M13 19h8"/><path d="m3 17 2 2 4-4"/><path d="m3 7 2 2 4-4"/></svg> Critical Issues (${t.length})</h4>\n                     <ul>\n                         ${t.map(t=>`<li>${this.getStepTitle(t.stepId)}: ${t.message}</li>`).join("")}\n                     </ul>\n                 </div>\n             `),e.length>0&&(s+=`\n                 <div class="recommendation-section">\n                     <h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 5h8"/><path d="M13 12h8"/><path d="M13 19h8"/><path d="m3 17 2 2 4-4"/><path d="m3 7 2 2 4-4"/></svg> Recommendations (${e.length})</h4>\n                     <ul>\n                         ${e.map(t=>`<li>${this.getStepTitle(t.stepId)}: ${t.message}</li>`).join("")}\n                     </ul>\n                 </div>\n             `),s+="</div>",s}getStepTitle(t){const e=this.getTroubleshootSteps().find(e=>e.id===t);return e?e.title:t}stopTroubleshooting(){this.isRunning=!1,this.updateProgress(0,0,"Troubleshooting stopped"),document.getElementById("troubleshoot-start").style.display="inline-flex",document.getElementById("troubleshoot-stop").style.display="none"}resetTroubleshooting(){this.isRunning=!1,this.currentStep=0,this.results=[],document.getElementById("troubleshoot-start").style.display="inline-flex",document.getElementById("troubleshoot-stop").style.display="none",document.getElementById("troubleshoot-summary").style.display="none",this.updateProgress(0,0,"Ready to start"),this.getTroubleshootSteps().forEach(t=>{this.updateStepStatus(t.id,"pending");const e=document.getElementById(`content-${t.id}`);e&&(e.style.display="none")})}applyRTLSupport(){if(window.gitManagerRTL&&window.gitManagerRTL.isRTLActive()){const t=document.querySelector(".troubleshoot-container");t&&(t.setAttribute("dir","rtl"),t.classList.add("repo-manager-rtl")),this.updateRTLayout()}else{const t=document.querySelector(".troubleshoot-container");t&&(t.setAttribute("dir","ltr"),t.classList.remove("repo-manager-rtl"))}}updateRTLayout(){const t=document.querySelector(".troubleshoot-title");t&&(t.style.flexDirection="row-reverse");const e=document.querySelector(".troubleshoot-progress");e&&(e.style.flexDirection="row-reverse"),document.querySelectorAll(".step-header").forEach(t=>{t.style.flexDirection="row-reverse"}),document.querySelectorAll(".step-icon").forEach(t=>{const e=window.getComputedStyle(t).marginRight;"0px"!==e&&(t.style.marginLeft=e,t.style.marginRight="0")}),document.querySelectorAll(".step-status").forEach(t=>{const e=window.getComputedStyle(t).marginLeft;"0px"!==e&&(t.style.marginRight=e,t.style.marginLeft="0")}),document.querySelectorAll(".step-info").forEach(t=>{t.style.textAlign="right"}),document.querySelectorAll(".step-message").forEach(t=>{t.style.flexDirection="row-reverse"});const s=document.querySelector(".troubleshoot-actions");s&&(s.style.flexDirection="row-reverse"),document.querySelectorAll(".troubleshoot-btn").forEach(t=>{t.style.flexDirection="row-reverse"});const o=document.querySelector(".troubleshoot-summary-content");o&&(o.style.textAlign="right");const n=document.querySelector(".troubleshoot-summary-content h3");n&&(n.style.flexDirection="row-reverse");const r=document.querySelector(".summary-stats");r&&(r.style.flexDirection="row-reverse"),document.querySelectorAll(".stat-item").forEach(t=>{t.style.flexDirection="row-reverse"}),document.querySelectorAll(".summary-recommendation").forEach(t=>{t.style.flexDirection="row-reverse"}),document.querySelectorAll(".recommendation-section h4").forEach(t=>{t.style.flexDirection="row-reverse"}),document.querySelectorAll(".recommendation-section ul").forEach(t=>{t.style.paddingLeft="0",t.style.paddingRight="24px"})}applyRTLToNewContent(){if(window.gitManagerRTL&&window.gitManagerRTL.isRTLActive()){document.querySelectorAll(".step-message").forEach(t=>{t.style.flexDirection="row-reverse";const e=t.querySelector("svg");e&&(e.style.marginRight="0",e.style.marginLeft="12px")}),document.querySelectorAll(".solution-content h4").forEach(t=>{t.style.flexDirection="row-reverse";const e=t.querySelector("svg");e&&(e.style.marginRight="0",e.style.marginLeft="8px")});const t=document.querySelector(".troubleshoot-summary-content h3");if(t){t.style.flexDirection="row-reverse";const e=t.querySelector("svg");e&&(e.style.marginRight="0",e.style.marginLeft="12px")}document.querySelectorAll(".stat-item").forEach(t=>{t.style.flexDirection="row-reverse";const e=t.querySelector("svg");e&&(e.style.marginRight="0",e.style.marginLeft="8px")}),document.querySelectorAll(".summary-recommendation").forEach(t=>{t.style.flexDirection="row-reverse";const e=t.querySelector("svg");e&&(e.style.marginRight="0",e.style.marginLeft="16px")}),document.querySelectorAll(".recommendation-section h4").forEach(t=>{t.style.flexDirection="row-reverse";const e=t.querySelector("svg");e&&(e.style.marginRight="0",e.style.marginLeft="8px")}),document.querySelectorAll(".recommendation-section ul").forEach(t=>{t.style.paddingLeft="0",t.style.paddingRight="24px"})}}getStatusIcon(t){switch(t){case"success":return'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>';case"warning":return'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8L22 12L18 16"/><path d="M2 12H22"/></svg>';case"error":return'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 16h.01"/><path d="M12 8v4"/><path d="M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688A2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z"/></svg>';default:return'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9.09 9 3.83 3.83L16.91 9"/></svg>'}}updateProgress(t,e,s){const o=document.getElementById("troubleshoot-progress-fill"),n=document.getElementById("troubleshoot-progress-text");if(o&&n){const r=e>0?t/e*100:0;o.style.width=`${r}%`,n.textContent=s}}async makeAjaxRequest(t,e={}){const s=new FormData;s.append("action",t);let o="";"undefined"!=typeof WPGitManagerGlobal&&WPGitManagerGlobal.action_nonces&&WPGitManagerGlobal.action_nonces[t]?o=WPGitManagerGlobal.action_nonces[t]:"undefined"!=typeof WPGitManagerGlobal&&WPGitManagerGlobal.nonce?o=WPGitManagerGlobal.nonce:"undefined"!=typeof gitManagerAjax&&gitManagerAjax.nonce?o=gitManagerAjax.nonce:document.getElementById("git_manager_nonce")?o=document.getElementById("git_manager_nonce").value:"undefined"!=typeof wpAjax&&wpAjax.nonce&&(o=wpAjax.nonce),s.append("nonce",o),Object.keys(e).forEach(t=>{s.append(t,e[t])});let n="";if(n="undefined"!=typeof ajaxurl?ajaxurl:"undefined"!=typeof gitManagerAjax&&gitManagerAjax.ajaxurl?gitManagerAjax.ajaxurl:"undefined"!=typeof wpAjax&&wpAjax.ajaxurl?wpAjax.ajaxurl:null,!n)throw new Error("AJAX URL not available. Please ensure the plugin is properly configured.");try{const t=await fetch(n,{method:"POST",body:s});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){return{success:!1,data:{status:"error",message:`AJAX request failed: ${t.message}`,solution:"Please check your network connection and try again. If the problem persists, contact your administrator.",details:t.toString()}}}}delay(t){return new Promise(e=>setTimeout(e,t))}}window.GitTroubleshooter=t,document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("run-troubleshoot");e&&e.addEventListener("click",function(e){e.preventDefault();const s=document.getElementById("troubleshoot-output");s&&(s.style.display="block"),window.gitTroubleshooter=new t;const o=window.GitManager&&window.GitManager.currentRepo?window.GitManager.currentRepo:null;window.gitTroubleshooter.init(o).then(()=>{window.gitTroubleshooter.startTroubleshooting()})}),document.getElementById("repo-manager-output")&&(window.GitManager&&window.GitManager.currentRepo?(window.gitTroubleshooter=new t,window.gitTroubleshooter.init(window.GitManager.currentRepo)):window.location.href.includes("repo-manager-troubleshooting")&&(window.gitTroubleshooter=new t,window.gitTroubleshooter.init()))})}();